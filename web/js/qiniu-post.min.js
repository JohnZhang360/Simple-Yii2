jQuery(function(){$.validator.addMethod("filetype",function(a,b,c){var d=a.substring(a.lastIndexOf(".")+1).toLowerCase();return this.optional(b)||$.inArray(d,c)!=-1},$.validator.format("invalid file type")),$("#formQiniu").validate({errorLabelContainer:$("div.error-container"),rules:{pic:{required:!0,filetype:["jpg","jpeg","png","ico","gif"]}},messages:{pic:{required:"Please upload image",filetype:"Please upload image"}},submitHandler:function(a){jQuery(a).ajaxSubmit({type:"post",dataType:"json",beforeSubmit:function(a,b,c){$("button[type='submit']").attr("disabled","disabled")},success:function(a){a.flag?window.location.href=$("#formQiniu").attr("data-url"):(alert(a.msg),$("button[type='submit']").removeAttr("disabled"))}})}})});